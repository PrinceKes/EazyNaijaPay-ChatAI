This still did not work i gues it's the account number creational that is causing the problem, now i am thinking that can it be possible to make the account creation in my telegram bot code instead because i want this app to be operating as a telegram mini app bot, now i already have a little features of the bot setup now i want to see if this will work like this:

After user /start the bot it gives them a welcome message with a inlinebutton to "Register an Account" the message sgould look like this:
"Welcome to EazyNaijaPay @usernname, you can click the button bellow to register your account with us(inlinekeyboardbutton with 'Register an Account')" once that button is press the bot reply with: 

"You've done well, now send your:
Email Address; (e.g micheal@gmail.com),
Phone Number; (e.g 07086597523),
Username; (e.g michealleo),
4 Digit Pin; (e.g 8909),"

after that the thelegram user type that kind of message to the telegram bot, the bot should reply with "Wait while we create your account for you..."

While that message appears the bot should send an instruction to the server.js to create the profile for that telegram user in the mongodb database then make sure that that user has a personal account number (that should be done using the Paystack api key: sk_live_b413933d1d3c91d10c6c3dfe5395bca5a86967f0)

Then once the user account has been successfully created the bot should return a message like this: "Hey @username", congratulations your account has been successfully created here is your Account Number: "8072975168" you can fun your account with that and you can use your username/email with your pin to login to your account on the mini app page"

in the message there should be a button that will open a web_app in the telegram that is the "Telegram mini app" which link is: https://eazynaijapay-app.onrender.com/


for user profile creation schema should be like this in the mongodb database
  email:
  phone:
  username:
  pin:
  accountNumber:
  accountBalance:
  transactions:
  UserIP

  but inside it the transaction Schema should look like this
  description:
  amount:
  status:
  date:

i want the server to be powerfull that it can force create "AllProfiles" collection inside the "
EazyNaijaPay-App" database that i have already

Can this be possible?

here are the bot.py code that i have already, can these functions be added to it?


Bot.py:

from telegram import Update, InlineKeyboardMarkup, InlineKeyboardButton, WebAppInfo
from telegram.ext import ApplicationBuilder, CommandHandler, ContextTypes
from pymongo import MongoClient
from datetime import datetime

MONGO_URI = "mongodb+srv://EazyNaijaPay:Adeboye2003@eazynaijapay.asnqh.mongodb.net/EazyNaijaPay-App?retryWrites=true&w=majority&appName=EazyNaijaPay"
client = MongoClient(MONGO_URI)
db = client["EazyNaijaPay-App"]
joined_users_collection = db["JoinedUsers"]


def add_user_to_db(user_id, username, first_name, last_name):
    user_data = {
        "user_id": user_id,
        "username": username,
        "first_name": first_name,
        "last_name": last_name,
        "joined_at": datetime.now(),
    }

    if not joined_users_collection.find_one({"user_id": user_id}):
        joined_users_collection.insert_one(user_data)
        print(f"New user added: {username}")
    else:
        print(f"User {username} already exists in the database.")


async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    user = update.effective_user

    add_user_to_db(user.id, user.username, user.first_name, user.last_name)

    message = "You are on the test mode for now. Click the button to view the EazyNaijaApp."

    web_app_url = "https://eazynaijapay-app.onrender.com/"
    keyboard = [
        [InlineKeyboardButton("Open EazyNaijaApp", web_app=WebAppInfo(url=web_app_url))]
    ]
    reply_markup = InlineKeyboardMarkup(keyboard)

    await update.message.reply_text(message, reply_markup=reply_markup)

def main():
    TOKEN = "8136531029:AAHlArThifhrPiOQuQv5HYi_gBpt7_XZFjA"  # Replace with your bot token

    application = ApplicationBuilder().token(TOKEN).build()

    application.add_handler(CommandHandler("start", start))

    print("Bot is running...")
    application.run_polling()


if __name__ == "__main__":
    main()
